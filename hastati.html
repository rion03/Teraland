<script>
  function showPendingUsers() {
    if (sessionStorage.getItem("isAdmin") !== "true") return;

    const pendingBox = document.getElementById("pending-users");
    const panel = document.getElementById("admin-panel");
    pendingBox.innerHTML = '';
    panel.style.display = "block";

    for (let key in localStorage) {
      if (key.startsWith("user_")) {
        const user = JSON.parse(localStorage.getItem(key));
        if (user.status === "pending") {
          const div = document.createElement("div");
          div.style.marginBottom = "10px";
          div.innerHTML = `
            üå± <strong>${user.nickname}</strong> (${user.id}, ${user.role})<br/>
            <button onclick="approveUser('${user.id}')">‚úÖ ÏäπÏù∏</button>
            <button onclick="rejectUser('${user.id}')">‚ùå Í±∞Ï†à</button>
          `;
          pendingBox.appendChild(div);
        }
      }
    }
  }

  function approveUser(id) {
    const user = JSON.parse(localStorage.getItem("user_" + id));
    user.status = "approved";
    localStorage.setItem("user_" + id, JSON.stringify(user));
    alert(`${user.nickname} ÏäπÏù∏ ÏôÑÎ£å`);
    showPendingUsers();
  }

  function rejectUser(id) {
    if (!confirm("Ï†ïÎßê Í±∞Ï†àÌïòÏãúÍ≤†ÏäµÎãàÍπå?")) return;
    localStorage.removeItem("user_" + id);
    alert("Í±∞Ï†à Î∞è ÏÇ≠Ï†ú ÏôÑÎ£å");
    showPendingUsers();
  }

  // ÌéòÏù¥ÏßÄ Î°úÎìúÏãú Í¥ÄÎ¶¨ÏûêÎ©¥ ÏäπÏù∏ Î™©Î°ù ÌëúÏãú
  window.onload = () => {
    if (sessionStorage.getItem("isAdmin") === "true") {
      showPendingUsers();
    }
  };
</script>

